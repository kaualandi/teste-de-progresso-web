<main class="page">
  <div class="container">
    <div class="content">
      <form class="filters" [formGroup]="form">
        <div class="row">
          <mat-form-field appearance="outline" class="year">
            <mat-label>Ano inicial</mat-label>
            <input
              matInput
              [matDatepicker]="dp"
              formControlName="start_year"
              [max]="now"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="dp"
            ></mat-datepicker-toggle>
            <mat-datepicker
              #dp
              startView="multi-year"
              (yearSelected)="setYear($event, dp, 'start_year')"
            >
            </mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" class="year">
            <mat-label>Ano final</mat-label>
            <input
              matInput
              [matDatepicker]="dp"
              formControlName="end_year"
              [max]="now"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="dp"
            ></mat-datepicker-toggle>
            <mat-datepicker
              #dp
              startView="multi-year"
              (yearSelected)="setYear($event, dp, 'end_year')"
            >
            </mat-datepicker>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Autoria</mat-label>
            <mat-select multiple formControlName="authorship">
              <mat-option value="own">Autorais</mat-option>
              <mat-option value="other">Não autorais</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Assuntos</mat-label>
            <mat-select multiple formControlName="subjects">
              <mat-option value="biologia">Biologia</mat-option>
              <mat-option value="fisica">Física</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="buttons end">
          <button type="submit" mat-raised-button color="primary">
            Filtrar
            <i *ngIf="!filtering" icon="filter"></i>
            <loading *ngIf="filtering" />
          </button>
        </div>
      </form>

      <div class="charts-container" *ngIf="!loading">
        <div class="row">
          <apx-chart
            [title]="difficultyChart.title"
            [labels]="difficultyChart.labels"
            [chart]="difficultyChart.chart"
            [colors]="difficultyChart.colors"
            [series]="difficultyChart.series"
            [plotOptions]="difficultyChart.plotOptions"
          ></apx-chart>
          <apx-chart
            [title]="cognitiveChart.title"
            [labels]="cognitiveChart.labels"
            [chart]="cognitiveChart.chart"
            [colors]="cognitiveChart.colors"
            [series]="cognitiveChart.series"
            [plotOptions]="cognitiveChart.plotOptions"
          ></apx-chart>
        </div>
        <div class="row">
          <apx-chart
            [title]="subjectsChart.title"
            [chart]="subjectsChart.chart"
            [xaxis]="subjectsChart.xaxis"
            [series]="subjectsChart.series"
            [plotOptions]="subjectsChart.plotOptions"
          ></apx-chart>
        </div>
      </div>
    </div>
  </div>
</main>
