<main class="page">
  <div class="container">
    <div class="content" *ngIf="!loading && !error">
      <form class="filters" [formGroup]="form">
        <div class="row">
          <mat-form-field appearance="outline" class="year">
            <mat-label>Ano inicial</mat-label>
            <input
              matInput
              [matDatepicker]="startYearDp"
              formControlName="start_year"
              [max]="now"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="startYearDp"
            ></mat-datepicker-toggle>
            <mat-datepicker
              #startYearDp
              startView="multi-year"
              (yearSelected)="setYear($event, startYearDp, 'start_year')"
            >
            </mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" class="year">
            <mat-label>Ano final</mat-label>
            <input
              matInput
              [matDatepicker]="endYearDp"
              formControlName="end_year"
              [max]="now"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="endYearDp"
            ></mat-datepicker-toggle>
            <mat-datepicker
              #endYearDp
              startView="multi-year"
              (yearSelected)="setYear($event, endYearDp, 'end_year')"
            >
            </mat-datepicker>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Autoria</mat-label>
            <mat-select multiple formControlName="authorship">
              <mat-option value="own">Autorais</mat-option>
              <mat-option value="other">NÃ£o autorais</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Assuntos</mat-label>
            <mat-select multiple formControlName="subjects">
              <mat-option *ngFor="let subject of subjects" [value]="subject.id">
                {{ subject.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="buttons end">
          <button type="submit" mat-raised-button color="primary">
            Filtrar
            <i *ngIf="!filtering" icon="filter"></i>
            <loading *ngIf="filtering" />
          </button>
        </div>
      </form>

      <div class="charts-container" *ngIf="!loading">
        <div class="row">
          <div class="chart-content">
            <apx-chart
              [title]="difficultyChart.title"
              [labels]="difficultyChart.labels"
              [chart]="difficultyChart.chart"
              [colors]="difficultyChart.colors"
              [series]="difficultyChart.series"
              [plotOptions]="difficultyChart.plotOptions"
            ></apx-chart>
          </div>
          <div class="chart-content">
            <apx-chart
              [title]="cognitiveChart.title"
              [labels]="cognitiveChart.labels"
              [chart]="cognitiveChart.chart"
              [colors]="cognitiveChart.colors"
              [series]="cognitiveChart.series"
              [plotOptions]="cognitiveChart.plotOptions"
            ></apx-chart>
          </div>
          <div class="chart-content">
            <apx-chart
              [title]="typeChart.title"
              [labels]="typeChart.labels"
              [chart]="typeChart.chart"
              [colors]="typeChart.colors"
              [series]="typeChart.series"
              [plotOptions]="typeChart.plotOptions"
            ></apx-chart>
          </div>
        </div>
        <div class="chart-content">
          <div class="radio-chart-select">
            <mat-radio-group [formControl]="barChartType">
              <mat-radio-button value="subjects">Dificuldade</mat-radio-button>
              <mat-radio-button value="types">Tipo</mat-radio-button>
            </mat-radio-group>
          </div>
          <apx-chart
            [title]="subjectsChart.title"
            [chart]="subjectsChart.chart"
            [xaxis]="subjectsChart.xaxis"
            [series]="subjectsChart.series"
            [plotOptions]="subjectsChart.plotOptions"
          ></apx-chart>
        </div>
      </div>
    </div>

    <page-error *ngIf="error" [code]="error" />
    <page-loading *ngIf="loading" />
  </div>
</main>
